# 项目配置文件

每个app的根目录下面,都有一个名为 `init.php` 的PHP文件, 该配置文件返回一个PHP数组,这个数组默认分为三个部分

	├─app 应用模块目录    
	│  ├─admin 后台模块  
	│  │  ├─init.php app配置文件
	│  │  ├─templates
	│  │  │  └─web
	│  │  │      ├─security
	│  │  │      ├─...
	│  │  │      └─default.layer.php 
	│  │  ├─controller 
	│  │  └─view
	│  │    
	│  └─web 网站模块  
	│     ├─init.php app配置文件
	│     ├─templates
	│     │  └─web
	│     │      ├─home
	│     │      ├─user
	│     │      ├─...
	│     │      └─default.layer.php 
	│     ├─controller
	│     └─view 


### 一. sys
app默认配置,用于指定默认模板目录等

1. `auth` 默认的认证方式, 使用SESSION或COOKIE.
2. `default_tpl_dir` 默认模板文件夹路径,可以在控制器中通过 `$this->config->set('sys', array('default_tpl_dir'=>'name'))` 来指定controller项目使用的模板.
3. `display` 默认的视图处理方法, 默认 `HTML` 使用视图控制器对应的方法来处理, `JSON` / `XML` 直接使用视图控制器中的JSON / XML方法来处理数据.

### 二. url
为每个app指定独立的url风格

1. `*` 指定默认的控制器和方法.

2. `type` 指定解析url的方式, 其中 `1`和`3` 处理`QUERY_STRING`格式的url, `2`和`4`处理`PATH_INFO`的方式生成的url, 假设生成连接的方法为 `$this->link("main:index", array('p1'=>1, 'p2'=>2, 'p3'=>3))` 那么根据type的值会生成以下四种风格的url:	
		
		1  skeleton/htdocs/web/?/main/index/1/2/3
		3  skeleton/htdocs/web/?/main/index/p1/1/p2/2/p3/3

		2  skeleton/htdocs/web/index.php/main/index?p1=1&p2=2&p3=3		
		4  skeleton/htdocs/web/index.php/main/index/p1/1/p2/2/p3/3

	由此可见,当 `type = 1` 的时候生成的url最短. 在控制器中使用 `$this->params` 可以获得通过url传递的参数, 当 `type = 1` 时, 需要在控制器方法的头部使用 `@cp_params p1, p2, p3` 来指定指定参数的key名称.

3. `rewrite` 用来控制生成url的时候是否隐藏url中的 `? `号或索引文件名, 当`type`的值为1或3的时候, apache对应的 `.htaccess` 文件内容如下:
		
		<IfModule mod_rewrite.c>
		RewriteEngine On
		RewriteCond %{REQUEST_FILENAME} -s [OR]
		RewriteCond %{REQUEST_FILENAME} -l [OR]
		RewriteCond %{REQUEST_FILENAME} -d
		RewriteRule ^.*$ - [NC,L]
		
		RewriteCond %{REQUEST_URI}::$1 ^(/.+)(.+)::\2$
		RewriteRule ^(.*) - [E=BASE:%1]
		RewriteRule ^(.*)$ %{ENV:BASE}index.php?$1 [NC,L]
		</IfModule>
	
	nginx 配置的rewrite配置如下:
		    
		location / {
	        if (!-f $request_filename) {
	            rewrite ^/(.*)$ /index.php?$1 last;
	        }
	    }
	当`type`的值为2或4的时候, 把上面两条规则中的 `index.php?` 替换为 `index.php/` 即可.

4. `dot` 用来指定生成url路径中的分隔符例如: `skeleton/htdocs/web/?/main/index/1/2/3`. 这里的dot的值为 `/`, 如果把dot的值改为 `-`, 那么重新生成后的url为: `skeleton/htdocs/web/?/main-index-1-2-3` dot可以指定为浏览器能识别的任何字符.

5. `ext` 用来指定生成url后缀, 假设指定 `ext` 的值为`.html` url `skeleton/htdocs/web/?/main/index/1/2/3` 重新生成的url为 `skeleton/htdocs/web/?/main/index/1/2/3.html`, 此时会强制检查url后最是否以 `.html` 结束, 否则会抛出一个找不到该页面的异常.

6. `index` 索引文件名称即htdocs目录对应app文件夹中的默认文件, 默认是 `index.php` 如果要使用其他的索引文件请修改此处. 

### 三. router 
router用于指定控制器的别名, 以以下配置为例:

	'router'    => array(
        'hi'    =>  'main:index',

        'article'   =>  array(
            'page'  =>  'index',
        ),
    ),

当请求的url是 `skeleton/htdocs/web/?/hi` 的时, 实际响应的是 `main` 控制器中的 `index` 方法
 
当请求的url是 `skeleton/htdocs/web/?/article/page` 的时, 实际响应的控制是 `article` 的 `index` 方法  

也可以在控制器中用静态属性 `_act_alias_` 来指定别名, 但优先级低于配置
